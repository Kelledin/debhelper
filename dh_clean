#!/usr/bin/perl -w
#
# Clean up $TMP and other tepmorary files generated by the
# build process.

BEGIN { push @INC, "debian", "/usr/lib/debhelper" }
use Dh_Lib;
init();

foreach $PACKAGE (@{$dh{DOPACKAGES}}) {
	$TMP=tmpdir($PACKAGE);
	$EXT=pkgext($PACKAGE);

	if (! $dh{D_FLAG}) {
		doit("rm","-f","debian/$EXT\substvars",
			"debian/$EXT\postinst.debhelper",
			"debian/$EXT\postrm.debhelper",
			"debian/$EXT\preinst.debhelper",
			"debian/$EXT\prerm.debhelper");
	}
	
	doit ("rm","-rf",$TMP);
}

if (! $dh{D_FLAG}) {
	if (@ARGV) {
		doit("rm","-f","--",@ARGV);
	}

	if (! $dh{K_FLAG}) {
		doit("rm","-f","debian/files");
	}

	# Remove other temp files.
	# (The \s+ is important, \s won't work because find would get null
	# parameters). Note that you _don't_ quote wildcards used by find
	# in here.
	doit(split(/\s+/,"find . -type f -a
	        ( -name #*# -o -name *~ -o -name DEADJOE
		 -o -name *.orig -o -name *.rej -o -name *.bak
		 -o -name .*.orig -o -name .*.rej -o -name .SUMS
		 -o -name TAGS -o -name core -o ( -path */.deps/* -a -name *.P )
		) -exec rm -f {} ;"));
}

doit('rm', '-rf', 'debian/tmp') if -x 'debian/tmp';
