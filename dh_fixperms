#!/bin/sh -e
#
# Do some general file permission fixups.

PATH=debian:$PATH:/usr/lib/debhelper
source dh_lib

for PACKAGE in $DH_DOPACKAGES; do
	TMP=`tmpdir $PACKAGE`
	EXT=`pkgext $PACKAGE`

	# General things..
	if [ -d debian/$TMP ]; then
		doit "chown -R root.root debian/$TMP"
		doit "chmod -R go=rX debian/$TMP"
	fi

	# Fix up premissions in usr/doc, setting everything to not exectable
	# by default.
	files=`find debian/$TMP/usr/doc -type f 2>/dev/null | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 644 $files"
	fi
	files=`find debian/$TMP/usr/doc -type d 2>/dev/null | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 755 $files"
	fi

	# Executable man pages are a bad thing.
	files=`find debian/$TMP/usr/man/ debian/$TMP/usr/X11*/man/ -type f 2>/dev/null | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 644 $files"
	fi
done
