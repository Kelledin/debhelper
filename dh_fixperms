#!/bin/sh -e
#
# Do some general file permission fixups.

PATH=debian:$PATH:/usr/lib/debhelper
. dh_lib

for PACKAGE in $DH_DOPACKAGES; do
	TMP=`tmpdir $PACKAGE`
	EXT=`pkgext $PACKAGE`

	# General things..
	if [ -d $TMP ]; then
		doit "chown -R root.root $TMP"
		doit "chmod -R go=rX $TMP"
	fi

	# Fix up premissions in usr/doc, setting everything to not exectable
	# by default, but leave examples directories alone.
	files=`find $TMP/usr/doc -type f 2>/dev/null | grep -v /examples/ | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 644 $files"
	fi
	files=`find $TMP/usr/doc -type d 2>/dev/null | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 755 $files"
	fi

	# Executable man pages are a bad thing.
	files=`find $TMP/usr/man/ $TMP/usr/X11*/man/ -type f 2>/dev/null | tr "\n" " "` || true
	if [ "$files" ]; then
		doit "chmod 644 $files"
	fi
done
